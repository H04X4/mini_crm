# üéØ Mini-CRM: –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ª–∏–¥–æ–≤

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤ –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ —Å —É—á—ë—Ç–æ–º –≤–µ—Å–æ–≤—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∏ –ª–∏–º–∏—Ç–æ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏.

![Python](https://img.shields.io/badge/Python-3.13+-blue.svg)
![FastAPI](https://img.shields.io/badge/FastAPI-0.109+-green.svg)
![SQLAlchemy](https://img.shields.io/badge/SQLAlchemy-2.0+-red.svg)

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ, –∞–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏
- **–ú—É–ª—å—Ç–∏–∫–∞–Ω–∞–ª—å–Ω–æ—Å—Ç—å** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (Telegram, WhatsApp, –≤–∏–¥–∂–µ—Ç—ã, VK)
- **–£–º–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** ‚Äî –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —Å —É—á—ë—Ç–æ–º —Ç–µ–∫—É—â–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏
- **–ï–¥–∏–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –æ–¥–∏–Ω –ª–∏–¥ –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞–≥—Ä—É–∑–∫–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.13+

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
git clone https://github.com/your-username/mini-crm.git
cd mini-crm


pip install -r requirements.txt

chmod +x ./start.sh
./start.sh
```

# API Documentation

## –û–ø–µ—Ä–∞—Ç–æ—Ä—ã

| –ú–µ—Ç–æ–¥ | Endpoint        | –û–ø–∏—Å–∞–Ω–∏–µ                         |
|-------|------------------|----------------------------------|
| POST  | /operators       | –°–æ–∑–¥–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞                |
| GET   | /operators       | –°–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π    |
| GET   | /operators/{id}  | –î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞                 |
| PATCH | /operators/{id}  | –û–±–Ω–æ–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞               |
| DELETE| /operators/{id}  | –£–¥–∞–ª–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞                |

---

## –ò—Å—Ç–æ—á–Ω–∏–∫–∏

| –ú–µ—Ç–æ–¥ | Endpoint        | –û–ø–∏—Å–∞–Ω–∏–µ                             |
|-------|------------------|----------------------------------------|
| POST  | /sources         | –°–æ–∑–¥–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫                       |
| GET   | /sources         | –°–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤                      |
| GET   | /sources/{id}    | –ò—Å—Ç–æ—á–Ω–∏–∫ —Å –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏    |
| PATCH | /sources/{id}    | –û–±–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫                      |
| DELETE| /sources/{id}    | –£–¥–∞–ª–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫                       |

---

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏—è

| –ú–µ—Ç–æ–¥ | Endpoint                                 | –û–ø–∏—Å–∞–Ω–∏–µ                                  |
|-------|-------------------------------------------|--------------------------------------------|
| POST  | /assignments                              | –ù–∞–∑–Ω–∞—á–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫ —Å –≤–µ—Å–æ–º    |
| DELETE| /assignments/{operator_id}/{source_id}    | –£–¥–∞–ª–∏—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ                         |

---

## –û–±—Ä–∞—â–µ–Ω–∏—è

| –ú–µ—Ç–æ–¥ | Endpoint                       | –û–ø–∏—Å–∞–Ω–∏–µ                               |
|-------|---------------------------------|------------------------------------------|
| POST  | /contacts                       | –°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ (–∞–≤—Ç–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)   |
| GET   | /contacts                       | –°–ø–∏—Å–æ–∫ –æ–±—Ä–∞—â–µ–Ω–∏–π                         |
| PATCH | /contacts/{id}/status           | –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å                          |
| POST  | /contacts/{id}/reassign         | –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞                  |

---

## –õ–∏–¥—ã

| –ú–µ—Ç–æ–¥ | Endpoint       | –û–ø–∏—Å–∞–Ω–∏–µ                   |
|-------|-----------------|----------------------------|
| GET   | /leads          | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ª–∏–¥–æ–≤          |
| GET   | /leads/{id}     | –õ–∏–¥ —Å–æ –≤—Å–µ–º–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏   |

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç–æ–¥ | Endpoint                | –û–ø–∏—Å–∞–Ω–∏–µ                          |
|-------|--------------------------|-----------------------------------|
| GET   | /stats                  | –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã          |
| GET   | /stats/sources/{id}     | –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É        |


# –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## 1. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–∏–¥–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –ª–∏–¥–∞ –ø–æ `external_id`:

- **–ù–∞–π–¥–µ–Ω** ‚Äî –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ª–∏–¥—É  
- **–ù–µ –Ω–∞–π–¥–µ–Ω** ‚Äî —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤–æ–≥–æ –ª–∏–¥–∞

---

## 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã =  
**–ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫**  
‚à© **–ê–∫—Ç–∏–≤–Ω—ã–µ (`is_active = true`)**  
‚à© **–ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω—ã–µ (`current_load < max_active_contacts`)**

---

## 3. –í–∑–≤–µ—à–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä

–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –≤–µ—Å—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞: P(–æ–ø–µ—Ä–∞—Ç–æ—Ä) = weight(–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞) / Œ£ weight(–≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ)

–ü—Ä–∏–º–µ—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏ –≤–µ—Å–∞—Ö **10**, **30**, **20**:

- ~17%
- ~50%
- ~33%

---

## 4. –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

–û–±—Ä–∞—â–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –±–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞: operator_id = NULL
–ü–æ–∑–∂–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å —á–µ—Ä–µ–∑: POST /contacts/{id}/reassign

---

## 5. –£—á—ë—Ç –Ω–∞–≥—Ä—É–∑–∫–∏

–ê–∫—Ç–∏–≤–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è ‚Äî —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏:

- `new`
- `in_progress`

–ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ (`status = closed`) –Ω–∞–≥—Ä—É–∑–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è.

---

# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞

```bash
curl -X POST http://localhost:8000/operators \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤",
    "is_active": true,
    "max_active_contacts": 10
  }
```
## –°–æ–∑–¥–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ 
```bash
curl -X POST http://localhost:8000/sources \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Telegram Bot",
    "code": "tg_main",
    "description": "–û—Å–Ω–æ–≤–Ω–æ–π Telegram –±–æ—Ç"
  }'
```

